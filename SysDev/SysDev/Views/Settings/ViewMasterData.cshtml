@model IEnumerable<SysDev.Models.MasterData>


@{
    ViewBag.Title = "Create Master Data";
    Layout = null;
}


<div class="box-body table-responsive no-padding" id="masterDataTable">
    <table class="table table-hover">
        <tr>
            <td></td>
            <td width="100px">Action</td>
        </tr>
        @foreach (var data in Model)
        {
            <tr>
                <td>
                    @{
                        var status = data.Status == "Active" ? "label-success" : "label-danger";
                    }
                    <p class="no-margin">
                        <a href="#" data-id="@data.Id" class="lead masterData">@data.Name</a>
                        <a href="#" class="label btnStatus @status" data-id="@data.Id" data-action="data">@data.Status</a>
                    </p>
                    <p class="no-margin label text-gray">
                        <small class="text-muted">@data.DateTimeCreated.ToString("MMM dd, yyyy hh:mm ff")</small>
                    </p>
                    <p class="no-margin">@data.Description</p>
                </td>
                <td>
                    <p><a href="#myModal" class="label text-blue btnEdit" data-from="data" data-toggle="modal" data-id="@data.Id"><i class="fa fa-pencil"></i> Edit</a></p>
                    <p><a href="#" class="label text-red btnDelete" data-from="data" data-id="@data.Id"><i class="fa fa-close"></i> Delete</a></p>
                </td>
            </tr>
        }
    </table>
</div>

<script>
    
    $(".masterData").click(function () {
        var id = $(this).data("id");
        $("#table-masterdetails").fadeOut(800, function () {
            $("#table-masterdetails").load("/Settings/ViewMasterDetails/" + id).fadeIn().delay(2000);
        });
    });

    $(".btnEdit").click(function (e) {
        $("#modal-content").load("/Settings/Edit/" + $(this).data("id") + "?from=" + $(this).data("from"));
    });

    $(".btnStatus").click(function (e) {
        var btnStatus = $(this);
        var requestStatus = (btnStatus.text() === "Active" ? "Inactive" : "Active");
        //alert("URL: @Url.Action("UpdateStatus", "UserProfile") | ID:" + $(this).data("id") + " | Class: " + btnStatus.hasClass("label-success"));
        //$("#modal-content").load("/UserProfile/UpdateStatus/" + $(this).data("id"));


        swal({
            title: "Want to set it " + requestStatus,
            type: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes'
        }).then(function () {
            swal('Please wait');
            swal.showLoading();
            $.ajax({
                url: "/Settings/UpdateStatus/" + btnStatus.data("id") + "?actionName=" + btnStatus.data("action"),
                type: "Post",
                data: btnStatus.data("id"),
                success: function (result) {
                    swal({
                        title: "Status was successfully change",
                        timer: 3000,
                        type: "success"
                    }).then(function () {
                        $("#masterDataTable").fadeOut(800, function () {
                            $("#masterDataTable").load("/Settings/ViewMasterData").fadeIn().delay(2000);
                        });
                        //btnStatus.removeClass(btnStatus.hasClass("label-success") ? 'label-success' : 'label-danger');
                        //btnStatus.text(requestStatus == "Active" ? "Active" : "Inactive");
                        //btnStatus.addClass(btnStatus.text() == "Active" ? "label-success" : "label-danger");
                    }).catch(swal.noop);

                }
            });
        }).catch(swal.noop);
    });

    $(".btnDelete").click(function (e) {
        var btnDelete = $(this);
        swal({
            title: "Remove this MasterData?",
            type: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes'
        }).then(function () {
            swal('Please wait');
            swal.showLoading();
            $.ajax({
                url: "/Settings/Delete/" + btnDelete.data("id") + "?from=" + btnDelete.data("from"),
                type: "Post",
                data: btnDelete.data("id"),
                success: function (result) {
                    swal({
                        title: "Account is now remove",
                        timer: 3000,
                        type: "success"
                    }).then(function() {
                        $("#masterDataTable").fadeOut(800, function () {
                            $("#masterDataTable").load("/Settings/ViewMasterData").fadeIn().delay(2000);
                        });
                    }).catch(swal.noop);
                    
                }
            });
        }).catch(swal.noop);

    });
</script>